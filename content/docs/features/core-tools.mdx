---
title: Core Tools
description: Built-in essential tools for memory persistence, file operations, math expressions and code execution.
---

These tools defined in the [core_tools](https://github.com/ServiceStack/llms/blob/main/llms/extensions/core_tools/__init__.py) extension provide essential functionality for LLMs to interact with their environment, perform calculations, and manage persistent data.

## Memory Tools

Functions for persistent key-value storage.

### `memory_read(key: str) -> Any`

Read a value from persistent memory.

- **key**: The key to retrieve.

### `memory_write(key: str, value: Any) -> bool`

Write a value to persistent memory.

- **key**: The storage key.
- **value**: The value to store.

## File System Tools

All file system operations are restricted to the current working directory for safety.

### `read_file(path: str) -> str`

Read a text file from disk.

- **path**: Relative path to the file.

### `write_file(path: str, content: str) -> bool`

Write text to a file (overwrites existing content).

- **path**: Relative path to the file.
- **content**: Text content to write.

### `list_directory(path: str) -> str`

List directory contents including file names, sizes, and modification times.

- **path**: Relative path to the directory.

### `glob_paths(pattern: str, extensions: List[str] = None, sort_by: str = "path", max_results: int = 100) -> Dict`

Find files and directories matching a glob pattern.

- **pattern**: Glob pattern to match.
- **extensions**: Optional list of file extensions to filter by.
- **sort_by**: Sort criteria ("path", "modified", "size").
- **max_results**: Maximum number of results to return.

## Search Tools

### `semantic_search(query: str, top_k: int = 5) -> List[Dict]`

Perform a semantic search (currently a placeholder implementation).

- **query**: The search query string.
- **top_k**: Number of top results to return.

## Math & Logic

### `calc(expression: str) -> str`

Evaluate a mathematical expression. Supports arithmetic, comparison, boolean operators, and common math functions.

- **expression**: The mathematical expression string (e.g., `sqrt(16) + 5`).

## Utilities

### `get_current_time(tz_name: str = None) -> str`

Get the current time in ISO-8601 format.

- **tz_name**: Optional timezone name (e.g., 'America/New_York'). Defaults to UTC.

## Code Execution Tools

LLMS includes a suite of tools for executing code in various languages within a sandboxed environment. These tools are designed to allow the agent to run scripts, perform calculations, and verify logic safely.

## Supported Languages

The following tools are available:

* `run_python(code)` - Executes Python code.
* `run_javascript(code)` - Executes JavaScript code (uses `bun` or `node`).
* `run_typescript(code)` - Executes TypeScript code (uses `bun` or `node`).
* `run_csharp(code)` - Executes C# code (uses `dotnet run` with .NET 10+ single-file support).

These tools allow LLMs to run code snippets dynamically as part of their reasoning process.

### Python and C# Examples

<ScreenshotsGallery className="mb-8" gridClass="grid grid-cols-1 md:grid-cols-2 gap-4" images={{
    'Run Python': '/img/tool-python.webp',
    'Run C#': '/img/tool-csharp.webp',
}} />

### JavaScript and TypeScript Examples

<ScreenshotsGallery className="mb-8" gridClass="grid grid-cols-1 md:grid-cols-2 gap-4" images={{
    'Run JavaScript': '/img/tool-javascript.webp',
    'Run TypeScript': '/img/tool-typescript.webp',
}} />

## Sandbox Environment

Code execution happens in a temporary, restricted environment to ensure safety and stability.

### Resource Limits
To prevent infinite loops or excessive resource consumption, the following limits are enforced using `ulimit` (on Linux/macOS):

- **Execution Time**: The process is limited to **5 seconds** of CPU time.
- **Memory**: The process is limited to **8 GB** virtual memory limit.

### File System
- Each execution runs in a **clean, temporary directory**.
- Converting `LLMS_RUN_AS` will try to `chmod 777` this directory so the target user can write to it.
- **Note**: Files created during execution are transient and lost after the tool completes, unless their content is printed to stdout.

### Environment Variables
- The environment is cleared to prevent leakage of sensitive tokens or API keys.
- Only the `PATH` variable is preserved to ensure standard tools function correctly.
- For C# (`dotnet`), `HOME` and `DOTNET_CLI_HOME` are set to the temporary directory to allow write access for the runtime intermediate files.

## Running with Lower Privileges (`LLMS_RUN_AS`)

By default, code runs as the user running the LLMS process. For enhanced security, you can configure the tools to execute code as a restricted user (e.g., `nobody` or a dedicated restricted user).

### Configuration

Set the `LLMS_RUN_AS` environment variable to the username you want code to run as.

**Example:**
```bash
export LLMS_RUN_AS=nobody
```

### Requirements for `LLMS_RUN_AS`
1. **Sudo Access**: The user running the LLMS process must have `sudo` privileges configured to run commands as the target user **without a password**.
2. **Permissions**: The LLMS process attempts to grant read/write access to the temporary execution directory for the target user (via `chmod 777`).

**Example `sudoers` configuration:**
```bash
# Allow 'mythz' to run commands as 'nobody' without password
mythz ALL=(nobody) NOPASSWD: ALL
```

### How it Works
When `LLMS_RUN_AS` is set:
1. A temporary directory is created.
2. Permissions on the directory are relaxed so the restricted user can access it.
3. The command is executed wrapped in `sudo -u <user>`.
   - Example: `sudo -u nobody bash -c 'ulimit -t 5; ... python script.py'`

This execution model ensures that even if malicious code escapes the `ulimit` sandbox or accesses the filesystem, it is restricted by the OS-level permissions of the `nobody` (or specified) user.
